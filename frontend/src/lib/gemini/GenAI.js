import {
    GoogleGenerativeAI,
    HarmCategory,
    HarmBlockThreshold
} from "@google/generative-ai";

const 
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
    model: "gemini-1.5-pro",
});

const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 64,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
};

export async function gen_trip(prompt) {
    const parts = [
        {text: "input: Travel to Chennai, Tamil Nadu, India, from date-Sun Aug 25 2024 00:00:00 GMT+0530 (India Standard Time) to date-Wed Aug 28 2024 00:00:00 GMT+0530 (India Standard Time). Travelling with-Couple. Activity preferences-Sightseeing.\ngenerate travel data according to the schema and in JSON format.\nDo not return anything in your response outside of curly braces.\nGenerate the response as per the function schema provided.\nDates given, activity preferences, and travelling with may influence the plan by 50%Follow JSON schema."},
        {text: "output: {\n  \"type\": \"object\",\n  \"properties\": {\n    \"aboutThePlace\": {\n      \"type\": \"string\",\n      \"description\": \"About the place in at least 50 words\"\n    },\n    \"bestTimeToVisit\": {\n      \"type\": \"string\",\n      \"description\": \"Best time to visit\"\n    },\n    \"adventuresActivitiesToDo\": {\n      \"type\": \"array\",\n      \"description\": \"Top adventures activities, at least 5, like trekking, water sports, specify the place also\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"localCuisineRecommendations\": {\n      \"type\": \"array\",\n      \"description\": \"Local Cuisine Recommendations\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"packingChecklist\": {\n      \"type\": \"array\",\n      \"description\": \"Packing Checklist\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"itinerary\": {\n      \"type\": \"array\",\n      \"description\": \"Itinerary for the specified number of days in array format\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"title\": {\n            \"type\": \"string\",\n            \"description\": \"Day title\"\n          },\n          \"activities\": {\n            \"type\": \"object\",\n            \"properties\": {\n              \"morning\": {\n                \"type\": \"array\",\n                \"items\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"itineraryItem\": {\n                      \"type\": \"string\",\n                      \"description\": \"About the itinerary item\"\n                    },\n                    \"briefDescription\": {\n                      \"type\": \"string\",\n                      \"description\": \"Elaborate about the place suggested\"\n                    }\n                  },\n                  \"required\": [\"itineraryItem\", \"briefDescription\"]\n                }\n              },\n              \"afternoon\": {\n                \"type\": \"array\",\n                \"items\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"itineraryItem\": {\n                      \"type\": \"string\",\n                      \"description\": \"About the itinerary item\"\n                    },\n                    \"briefDescription\": {\n                      \"type\": \"string\",\n                      \"description\": \"Elaborate about the place suggested\"\n                    }\n                  },\n                  \"required\": [\"itineraryItem\", \"briefDescription\"]\n                }\n              },\n              \"evening\": {\n                \"type\": \"array\",\n                \"items\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"itineraryItem\": {\n                      \"type\": \"string\",\n                      \"description\": \"About the itinerary item\"\n                    },\n                    \"briefDescription\": {\n                      \"type\": \"string\",\n                      \"description\": \"Elaborate about the place suggested\"\n                    }\n                  },\n                  \"required\": [\"itineraryItem\", \"briefDescription\"]\n                }\n              }\n            },\n            \"required\": [\"morning\", \"afternoon\", \"evening\"]\n          }\n        },\n        \"required\": [\"title\", \"activities\"]\n      }\n    },\n    \"topplacestovisit\": {\n      \"type\": \"array\",\n      \"description\": \"Top places to visit along with their coordinates, at least top 5, can be more\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\",\n            \"description\": \"Name of the place\"\n          },\n          \"coordinates\": {\n            \"type\": \"object\",\n            \"properties\": {\n              \"lat\": {\n                \"type\": \"number\",\n                \"description\": \"Latitude\"\n              },\n              \"lng\": {\n                \"type\": \"number\",\n                \"description\": \"Longitude\"\n              }\n            },\n            \"required\": [\"lat\", \"lng\"]\n          }\n        },\n        \"required\": [\"name\", \"coordinates\"]\n      }\n    }\n  },\n  \"required\": [\"aboutThePlace\", \"bestTimeToVisit\", \"adventuresActivitiesToDo\", \"localCuisineRecommendations\", \"packingChecklist\", \"itinerary\", \"topplacestovisit\"]\n}"},
        {text: "input: Travel to Varanasi, Uttar Pradesh, India, from date-Fri Oct 25 2024 00:00:00 GMT+0530 (India Standard Time) to date-Sat Nov 02 2024 00:00:00 GMT+0530 (India Standard Time). Travelling with-Family. Activity preferences-Cultural Experiences, Relaxation.\ngenerate travel data according to the schema and in JSON format.\nDo not return anything in your response outside of curly braces.\nGenerate the response as per the function schema provided.\nDates given, activity preferences, and travelling with may influence the plan by 50%Follow JSON schema."},
        {text: "output: {\"aboutThePlace\": \"Varanasi, one of the oldest continuously inhabited cities in the world, is a city of immense spiritual significance for Hindus. Located on the banks of the sacred Ganges River, it's a place where life and death intertwine, with cremation ghats and vibrant rituals drawing pilgrims and visitors alike. The city is a sensory overload, with narrow alleyways bustling with activity, the scent of incense filling the air, and the sound of temple bells echoing through the streets. It's a place to witness ancient traditions, experience the divine, and perhaps even find a sense of peace amidst the chaos.\", \"bestTimeToVisit\": \"October to March\", \"adventuresActivitiesToDo\": [\"Boat Ride on the Ganges: Witness the sunrise over the ghats from a traditional wooden boat.\", \"Attend the Ganga Aarti Ceremony: Experience the mesmerizing evening prayer ritual on the Dashashwamedh Ghat.\", \"Explore Sarnath: Discover the Buddhist pilgrimage site where Buddha delivered his first sermon.\", \"Ramnagar Fort: Visit the 18th-century fort across the Ganges, known for its museum and Ramlila performances.\"], \"localCuisineRecommendations\": [\"Kachori Sabzi: Deep-fried lentil dumplings served with spicy potato curry.\", \"Baati Chokha: Baked wheat balls served with roasted eggplant and potato.\", \"Thandai: A refreshing milk-based drink infused with nuts, spices, and sometimes cannabis.\", \"Lassi: A yogurt-based drink, available in sweet and savory flavors.\"], \"packingChecklist\": [\"Loose, comfortable clothing: Respectful attire for temples (covering shoulders and legs).\", \"Scarf or shawl: For covering your head and face when entering temples or crowded areas.\", \"Comfortable walking shoes: For exploring the ghats and narrow streets.\", \"Hand sanitizer and wet wipes: For maintaining hygiene.\", \"Sunscreen, hat, sunglasses: For protection from the sun.\", \"Mosquito repellent: Especially important during the evenings.\", \"First-aid kit: For minor cuts, bites, or ailments.\", \"Power bank: For charging electronic devices.\"], \"itinerary\": [{\"title\": \"Day 1: Arrival and Ganges Exploration\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Arrival and Check-in\", \"briefDescription\": \"Arrive at Varanasi (VNS airport or railway station) and check into your accommodation near the ghats for a more immersive experience.\"}, {\"itineraryItem\": \"Boat Ride on the Ganges\", \"briefDescription\": \"Take a serene boat ride along the ghats, witnessing the rituals, life, and death that unfold by the river. Opt for a sunrise boat ride for a magical experience.\"}], \"afternoon\": [{\"itineraryItem\": \"Explore the Ghats\", \"briefDescription\": \"Walk along the ghats, each with its own unique significance and history. Visit the Manikarnika Ghat, Dashashwamedh Ghat, and Assi Ghat, among others.\"}, {\"itineraryItem\": \"Relax and Absorb\", \"briefDescription\": \"Find a peaceful spot along the ghats to sit, relax, and soak in the atmosphere. Watch the sunset over the Ganges for a memorable experience.\"}], \"evening\": [{\"itineraryItem\": \"Ganga Aarti Ceremony\", \"briefDescription\": \"Attend the mesmerizing evening prayer ritual at the Dashashwamedh Ghat. Witness the synchronized movements of the priests, the chanting of mantras, and the offerings made to the river.\"}, {\"itineraryItem\": \"Dinner\", \"briefDescription\": \"Enjoy a delicious dinner at one of the many restaurants near the ghats, savoring local Varanasi cuisine.\"}]}}, {\"title\": \"Day 2: Sarnath and Spiritual Exploration\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Visit Sarnath\", \"briefDescription\": \"Embark on a day trip to Sarnath, a significant Buddhist pilgrimage site where Buddha delivered his first sermon. Explore the ancient ruins, stupas, and monasteries.\"}, {\"itineraryItem\": \"Dhamek Stupa\", \"briefDescription\": \"Marvel at the Dhamek Stupa, marking the spot where Buddha gave his first teaching after attaining enlightenment.\"}], \"afternoon\": [{\"itineraryItem\": \"Sarnath Museum\", \"briefDescription\": \"Visit the Sarnath Museum, home to a remarkable collection of Buddhist art and artifacts, including the famous Lion Capital of Ashoka.\"}, {\"itineraryItem\": \"Return to Varanasi\", \"briefDescription\": \"Return to Varanasi and enjoy some free time to relax or explore the city further.\"}], \"evening\": [{\"itineraryItem\": \"Attend a Classical Music Performance\", \"briefDescription\": \"Varanasi is known for its rich musical heritage. Consider attending a classical music or dance performance at a local venue.\"}, {\"itineraryItem\": \"Dinner\", \"briefDescription\": \"Enjoy dinner at a rooftop restaurant, savoring delicious local food and enjoying panoramic city views.\"}]}}, {\"title\": \"Day 3: Cultural Immersion and Departure\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Explore the Old City\", \"briefDescription\": \"Get lost in the labyrinthine alleyways of Varanasi's old city. Discover hidden temples, bustling markets, and traditional workshops.\"}, {\"itineraryItem\": \"Shopping\", \"briefDescription\": \"Browse for souvenirs and local handicrafts, such as silk sarees, brassware, and wooden toys.\"}], \"afternoon\": [{\"itineraryItem\": \"Visit the Ramnagar Fort\", \"briefDescription\": \"Take a boat across the Ganges to visit the Ramnagar Fort, an 18th-century fort known for its museum and annual Ramlila performances.\"}, {\"itineraryItem\": \"Relax and Reflect\", \"briefDescription\": \"Spend some quiet time reflecting on your Varanasi experience by the river or at a peaceful garden.\"}], \"evening\": [{\"itineraryItem\": \"Departure\", \"briefDescription\": \"Depart from Varanasi (VNS airport or railway station) with cherished memories of this spiritual city.\"}]}}], \"topplacestovisit\": [{\"name\": \"Dashashwamedh Ghat\", \"coordinates\": {\"lat\": 25.3064, \"lng\": 83.0098}}, {\"name\": \"Manikarnika Ghat\", \"coordinates\": {\"lat\": 25.3077, \"lng\": 83.0083}}, {\"name\": \"Assi Ghat\", \"coordinates\": {\"lat\": 25.2975, \"lng\": 83.0192}}, {\"name\": \"Sarnath\", \"coordinates\": {\"lat\": 25.3794, \"lng\": 83.0104}}, {\"name\": \"Ramnagar Fort\", \"coordinates\": {\"lat\": 25.2683, \"lng\": 83.0378}}]}"},
        {text: "input: Travel to Visakhapatnam, Andhra Pradesh, India, from date-Fri Oct 25 2024 00:00:00 GMT+0530 (India Standard Time) to date-Sat Nov 02 2024 00:00:00 GMT+0530 (India Standard Time). Travelling with-Group. Activity preferences-Adventure, Relaxation, Nightlife.\ngenerate travel data according to the schema and in JSON format.\nDo not return anything in your response outside of curly braces.\nGenerate the response as per the function schema provided.\nDates given, activity preferences, and travelling with may influence the plan by 50%Follow JSON schema."},
        {text: "output: {\"aboutThePlace\": \"Visakhapatnam, fondly called Vizag, is a vibrant coastal city in Andhra Pradesh, India. Nestled amidst the Eastern Ghats and the Bay of Bengal, it boasts stunning beaches, lush hills, and a rich history. Known for its shipbuilding and naval base, Vizag offers a unique blend of natural beauty, cultural heritage, and modern attractions. From exploring ancient temples to indulging in thrilling adventure sports, this city caters to diverse interests. It's a perfect destination for those seeking a mix of relaxation, adventure, and cultural immersion.\", \"bestTimeToVisit\": \"October to March\", \"adventuresActivitiesToDo\": [\"Explore the Araku Valley: Experience the breathtaking beauty of the valley, known for its coffee plantations, tribal villages, and cascading waterfalls. Enjoy trekking, boating, and sightseeing.\", \"Water Sports at Rushikonda Beach: Indulge in a variety of water sports, including surfing, windsurfing, parasailing, and jet skiing.\", \"Trekking at Kailasa Giri: Hike to the summit of Kailasa Giri, offering panoramic views of the city and coastline. Enjoy the fresh air and lush greenery.\", \"Dolphin Watching: Embark on a thrilling boat trip to spot playful dolphins in the Bay of Bengal.\", \"Scuba Diving at Bheemunipatnam: Experience the underwater wonders of the Bay of Bengal with scuba diving excursions.\"], \"localCuisineRecommendations\": [\"Prawns Curry: Savory and spicy prawns cooked in a coconut-based curry.\", \"Fish Fry: Freshly caught fish, deep-fried to perfection and served with chutneys.\", \"Biryani: Aromatic rice dish infused with spices and various meats, a popular street food.\", \"Idli Dosa: Steamed rice cakes and crispy lentil crepes served with various chutneys and sambhar.\", \"Guntur Chilli Chicken: Spicy and flavorful chicken dish with a kick from Guntur chilies.\"], \"packingChecklist\": [\"Comfortable clothing: For exploring, trekking, and lounging on the beach.\", \"Swimsuit and beachwear: For enjoying the sun and sand.\", \"Hiking shoes or comfortable walking shoes: For trekking and exploring hills and beaches.\", \"Sunscreen, hat, and sunglasses: To protect yourself from the sun.\", \"Mosquito repellent: To keep those pesky insects away.\", \"Camera: To capture the beauty of Vizag's landscapes and experiences.\", \"First-aid kit: For minor cuts, bites, or ailments.\", \"Power bank: For charging electronic devices.\"], \"itinerary\": [{\"title\": \"Day 1: Arrival and Beach Bliss\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Arrival and Check-in\", \"briefDescription\": \"Arrive at Visakhapatnam (VTZ airport or railway station) and check into your hotel near the beach for easy access to the seaside fun.\"}, {\"itineraryItem\": \"Rushikonda Beach\", \"briefDescription\": \"Head to Rushikonda Beach, a pristine stretch of golden sand, known for its scenic beauty and water sports. Relax, swim, or indulge in activities like surfing, windsurfing, or parasailing.\"}], \"afternoon\": [{\"itineraryItem\": \"Lunch at a Beachside Restaurant\", \"briefDescription\": \"Enjoy a delicious lunch at one of the beachside restaurants, savoring fresh seafood and the sea breeze.\"}, {\"itineraryItem\": \"Explore the Beachfront\", \"briefDescription\": \"Take a leisurely stroll along the beach, soak in the sun, or build sandcastles with your group. Enjoy the vibrant atmosphere and the sound of crashing waves.\"}], \"evening\": [{\"itineraryItem\": \"Sunset at Yarada Beach\", \"briefDescription\": \"Drive to Yarada Beach, another beautiful beach known for its scenic beauty and rock formations. Witness a mesmerizing sunset over the Bay of Bengal.\"}, {\"itineraryItem\": \"Dinner and Nightlife\", \"briefDescription\": \"Enjoy dinner at a local restaurant, sampling authentic Vizag cuisine. Afterwards, head to one of the city's nightclubs or pubs for a lively evening.\"}]}}, {\"title\": \"Day 2: Exploring Vizag's Charms\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Visit the Kailasa Giri\", \"briefDescription\": \"Start your day with a hike to the summit of Kailasa Giri, a scenic hill offering panoramic views of the city and coastline. Enjoy the fresh air and the lush greenery.\"}, {\"itineraryItem\": \"Explore the Naval Base\", \"briefDescription\": \"Visit the Naval Base, a significant landmark in Vizag, and learn about the city's maritime heritage. Explore the submarine museum for a deeper understanding of naval operations.\"}], \"afternoon\": [{\"itineraryItem\": \"Indulge in Street Food\", \"briefDescription\": \"Take a culinary journey through Vizag's vibrant street food scene. Sample delicious local snacks like idli, dosa, and pani puri. Enjoy the flavors of Andhra cuisine.\"}, {\"itineraryItem\": \"Shopping at the Market\", \"briefDescription\": \"Visit the local market for some souvenir shopping. Browse through traditional handicrafts, textiles, and local produce.\"}], \"evening\": [{\"itineraryItem\": \"Dolphin Watching Trip\", \"briefDescription\": \"Embark on a thrilling boat trip to spot playful dolphins in the Bay of Bengal. Enjoy the beauty of the coastline and the chance to witness marine life up close.\"}, {\"itineraryItem\": \"Dinner at a Rooftop Restaurant\", \"briefDescription\": \"Enjoy a delicious dinner at a rooftop restaurant, savoring panoramic city views and enjoying a delightful evening.\"}]}}, {\"title\": \"Day 3: History, Nature, and Relaxation\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Visit the Simhachalam Temple\", \"briefDescription\": \"Explore the historic Simhachalam Temple, dedicated to Lord Narasimha. Admire the intricate architecture and the serene atmosphere of this ancient temple.\"}, {\"itineraryItem\": \"Explore the Dolphin's Nose\", \"briefDescription\": \"Drive to Dolphin's Nose, a scenic viewpoint overlooking the Bay of Bengal. Enjoy the breathtaking panoramic views and capture memorable photographs.\"}], \"afternoon\": [{\"itineraryItem\": \"Araku Valley Tour\", \"briefDescription\": \"Embark on a scenic drive to the Araku Valley, famous for its coffee plantations, tribal villages, and stunning waterfalls. Enjoy the picturesque landscapes and the serene atmosphere.\"}, {\"itineraryItem\": \"Visit the Tribal Museum\", \"briefDescription\": \"Explore the Araku Tribal Museum, showcasing the culture, traditions, and artifacts of the local tribes. Learn about their unique way of life.\"}], \"evening\": [{\"itineraryItem\": \"Relaxation and Spa\", \"briefDescription\": \"Return to your hotel and indulge in some relaxation at the spa. Enjoy a massage or other treatments to unwind and rejuvenate after your adventures.\"}, {\"itineraryItem\": \"Farewell Dinner\", \"briefDescription\": \"Enjoy a final farewell dinner with your group, reminiscing about your Vizag experiences.\"}]}}, {\"title\": \"Day 4: Departure\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Departure\", \"briefDescription\": \"Depart from Visakhapatnam (VTZ airport or railway station) with cherished memories of your adventures in Vizag.\"}]}}], \"topplacestovisit\": [{\"name\": \"Rushikonda Beach\", \"coordinates\": {\"lat\": 17.7187, \"lng\": 83.3028}}, {\"name\": \"Yarada Beach\", \"coordinates\": {\"lat\": 17.6861, \"lng\": 83.2732}}, {\"name\": \"Kailasa Giri\", \"coordinates\": {\"lat\": 17.7277, \"lng\": 83.3135}}, {\"name\": \"Simhachalam Temple\", \"coordinates\": {\"lat\": 17.7406, \"lng\": 83.3370}}, {\"name\": \"Dolphin's Nose\", \"coordinates\": {\"lat\": 17.7661, \"lng\": 83.2896}}, {\"name\": \"Araku Valley\", \"coordinates\": {\"lat\": 18.0530, \"lng\": 82.7718}}]}"},
        {text: "input: Travel to Hyderabad, Telangana, India, from date-Mon Aug 26 2024 00:00:00 GMT+0530 (India Standard Time) to date-Wed Aug 28 2024 00:00:00 GMT+0530 (India Standard Time). Travelling with-Solo. Activity preferences-Shopping, Nightlife.\ngenerate travel data according to the schema and in JSON format.\nDo not return anything in your response outside of curly braces.\nGenerate the response as per the function schema provided.\nDates given, activity preferences, and travelling with may influence the plan by 50%Follow JSON schema."},
        {text: "output: {\"aboutThePlace\": \"Hyderabad, the vibrant capital of Telangana, is a city brimming with history, culture, and modern amenities. Often called the 'City of Pearls', it boasts a rich legacy, evident in its magnificent forts, palaces, and mosques. From the grand Charminar to the bustling Laad Bazaar, Hyderabad offers a captivating blend of tradition and modernity. It's a city that pulsates with life, offering a plethora of shopping experiences, delectable cuisine, and a vibrant nightlife scene. \", \"bestTimeToVisit\": \"October to March\", \"adventuresActivitiesToDo\": [\"Explore the Charminar: Admire the iconic mosque, a symbol of Hyderabad's heritage. Wander through the bustling market surrounding it, known for its traditional jewelry, handicrafts, and textiles.\", \"Visit the Golconda Fort: Discover the grand 16th-century fort, renowned for its architectural brilliance and historical significance. Attend a sound and light show for a magical evening experience.\", \"Experience the Qutb Shahi Tombs: Visit the serene tombs of the Qutb Shahi dynasty, renowned for their intricate architecture and elegant design. Immerse yourself in the peaceful ambiance.\", \"Explore the Salar Jung Museum: Discover one of India's largest museums, housing a vast collection of artifacts, paintings, and sculptures from around the world. Immerse yourself in art and history.\", \"Attend a Traditional Dance Performance: Witness the captivating performances of classical Indian dances, such as Kuchipudi or Bharatanatyam. Enjoy the grace and storytelling of these art forms.\"], \"localCuisineRecommendations\": [\"Hyderabadi Biryani: A world-famous dish, featuring aromatic rice, tender meat, and a blend of spices. Try it at iconic restaurants like Bawarchi or Paradise.\", \"Haleem: A rich and flavorful stew made with meat, lentils, and spices, a popular dish during Ramadan. Enjoy it at traditional restaurants like Shah Ghouse.\", \"Irani Chai: A strong and flavorful tea, often enjoyed with Osmania biscuits. Experience the local chai culture at Irani cafes like Nimrah or Karachi Bakery.\", \"Mirchi Ka Salan: A spicy and tangy curry made with green chilies, onions, and yogurt, a popular accompaniment to Hyderabadi Biryani.\", \"Qubani ka Meetha: A sweet and delicious dessert made with dried apricots, milk, and sugar. Enjoy it for a flavorful end to your meal.\"], \"packingChecklist\": [\"Comfortable clothing: For exploring the city and attending events.\", \"Walking shoes: For navigating the bustling streets and historical sites.\", \"Sunscreen, hat, and sunglasses: For protection from the sun, especially during outdoor activities.\", \"Scarf or shawl: For covering your head and shoulders when visiting religious sites.\", \"Camera: To capture memories of your journey.\", \"Power bank: For charging electronic devices.\", \"Travel adapter: If required, for using your electronic devices.\", \"Personal hygiene items: To ensure comfort and cleanliness.\"], \"itinerary\": [{\"title\": \"Day 1: Arrival and Shopping Spree\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Arrival and Check-in\", \"briefDescription\": \"Arrive at Hyderabad (HYD airport or railway station) and check into your hotel. Choose a hotel in the heart of the city for easy access to attractions and shopping.\"}, {\"itineraryItem\": \"Explore Laad Bazaar\", \"briefDescription\": \"Head to Laad Bazaar, a bustling market known for its traditional jewelry, bangles, and handicrafts. Enjoy the vibrant atmosphere and unique finds.\"}], \"afternoon\": [{\"itineraryItem\": \"Lunch at a Local Restaurant\", \"briefDescription\": \"Enjoy a delicious lunch at one of the many restaurants in the old city, savoring authentic Hyderabadi cuisine.\"}, {\"itineraryItem\": \"Shop at the Abids Market\", \"briefDescription\": \"Explore the Abids Market, a commercial hub offering a wide range of goods, including clothing, electronics, and accessories. Find unique souvenirs and trendy items.\"}], \"evening\": [{\"itineraryItem\": \"Visit the Charminar\", \"briefDescription\": \"Admire the iconic Charminar, a symbol of Hyderabad. Wander through the market surrounding it, known for its traditional jewelry and handicrafts.\", \"briefDescription\": \"Enjoy a delicious dinner at a rooftop restaurant, savoring panoramic city views and enjoying a delightful evening.\"}]}}, {\"title\": \"Day 2: Cultural Delights and Nightlife\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Explore the Qutb Shahi Tombs\", \"briefDescription\": \"Visit the serene tombs of the Qutb Shahi dynasty, renowned for their intricate architecture and elegant design. Immerse yourself in the peaceful ambiance.\"}, {\"itineraryItem\": \"Visit the Salar Jung Museum\", \"briefDescription\": \"Discover one of India's largest museums, housing a vast collection of artifacts, paintings, and sculptures from around the world. Immerse yourself in art and history.\"}], \"afternoon\": [{\"itineraryItem\": \"Lunch at a Traditional Restaurant\", \"briefDescription\": \"Enjoy a delicious lunch at a traditional restaurant, savoring authentic Hyderabadi cuisine. Try the famous Hyderabadi Biryani or Haleem.\"}, {\"itineraryItem\": \"Relax and Explore\", \"briefDescription\": \"Enjoy some free time to relax at your hotel or explore the city further. Visit the Hussain Sagar Lake for a peaceful evening walk.\"}], \"evening\": [{\"itineraryItem\": \"Dinner and Nightlife\", \"briefDescription\": \"Enjoy a delicious dinner at one of the city's many restaurants, savoring local flavors. Afterwards, head to a bar or nightclub for a lively evening.\"}]}}, {\"title\": \"Day 3: Departure\", \"activities\": {\"morning\": [{\"itineraryItem\": \"Departure\", \"briefDescription\": \"Depart from Hyderabad (HYD airport or railway station) with cherished memories of your shopping and nightlife adventures in this vibrant city.\"}]}}], \"topplacestovisit\": [{\"name\": \"Charminar\", \"coordinates\": {\"lat\": 17.3608, \"lng\": 78.4738}}, {\"name\": \"Laad Bazaar\", \"coordinates\": {\"lat\": 17.3610, \"lng\": 78.4743}}, {\"name\": \"Golconda Fort\", \"coordinates\": {\"lat\": 17.4023, \"lng\": 78.4176}}, {\"name\": \"Qutb Shahi Tombs\", \"coordinates\": {\"lat\": 17.3639, \"lng\": 78.4541}}, {\"name\": \"Salar Jung Museum\", \"coordinates\": {\"lat\": 17.3613, \"lng\": 78.4792}}, {\"name\": \"Abids Market\", \"coordinates\": {\"lat\": 17.3684, \"lng\": 78.4721}}]}"},
        {text: `${prompt}`},
    ];

    let result = await model.generateContent({
        contents: [{role: "user", parts}],
        generationConfig,
    });

    return JSON.stringify(result.response.text());
}


export async function getChatResponse(history) {
    history =  [{
    role: "user",
    parts: [
      {text: "Hi! can you plan trip"},
    ],
  },{
    role: "model",
    parts: [
      {text: "I'd love to help you plan a trip! To get started, could you provide me with some details?"},
    ],
  },...history]
    const generationConfig = {
        temperature: 1,
        topP: 0.95,
        topK: 64,
        maxOutputTokens: 8192,
        responseMimeType: "text/plain",
    };
    if (history[0].role !== "user") {
    throw new Error("The first message in the history must be from the user.");
  }


  const chatSession = model.startChat({
    generationConfig,
    history:history,
  });
    console.log(history)
  const result = await chatSession.sendMessage(history[history.length - 1].parts[0].text);
  return result.response.text();
}

